\documentclass[11pt,a4paper]{article} 

% PACKAGES FOR TITLES
\usepackage{titlesec}
\usepackage{color}

% PACKAGES FOR LANGUAGE AND FONT
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc} % Font encoding

% PACKAGES FOR IMAGES
\usepackage{graphicx}
\graphicspath{{img/}}
\usepackage{eso-pic} % For the background picture on the title page
\usepackage{subfig} % Numbered and caption subfigures using \subfloat
\usepackage{caption} % Coloured captions
\usepackage{transparent}

% STANDARD MATH PACKAGES
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage[overload]{empheq}  % For braced-style systems of equations

% PACKAGES FOR TABLES
\usepackage{tabularx}
\usepackage{longtable} % tables that can span several pages
\usepackage{colortbl}

% PACKAGES FOR ALGORITHMS (PSEUDO-CODE)
\usepackage{algorithm}
\usepackage{algorithmic}

% PACKAGES FOR REFERENCES & BIBLIOGRAPHY
\usepackage[colorlinks=true,linkcolor=black,anchorcolor=black,citecolor=black,filecolor=black,menucolor=black,runcolor=black,urlcolor=black]{hyperref} % Adds clickable links at references
\usepackage{cleveref}
\usepackage[square, numbers, sort&compress]{natbib} % Square brackets, citing references with numbers, citations sorted by appearance in the text and compressed
\bibliographystyle{plain} % You may use a different style adapted to your field

% PACKAGES FOR THE APPENDIX
\usepackage{appendix}

% PACKAGES FOR ITEMIZE & ENUMERATES 
\usepackage{enumitem}

% OTHER PACKAGES
\usepackage{amsthm,thmtools,xcolor} % Coloured "Theorem"
\usepackage{comment} % Comment part of code
\usepackage{fancyhdr} % Fancy headers and footers
\usepackage{lipsum} % Insert dummy text
\usepackage{tcolorbox} % Create coloured boxes (e.g. the one for the key-words)

\newcommand{\bea}{\begin{eqnarray}} % Shortcut for equation arrays
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\e}[1]{\times 10^{#1}}  % Powers of 10 notation
\newcommand{\mathbbm}[1]{\text{\usefont{U}{bbm}{m}{n}#1}} % From mathbbm.sty
\newcommand{\pdev}[2]{\frac{\partial#1}{\partial#2}}

\input{config_files/config}

\renewcommand{\title}{DWA vs custom trajectory tracking controller: a comparison in ROS}
\newcommand{\AUTHORa}{Giuseppe Chiari}
\newcommand{\IDa}{10576799}
\newcommand{\AUTHORb}{Leonardo Gargani}
\newcommand{\IDb}{10569221}
\newcommand{\AUTHORc}{Serena Salvi}
\newcommand{\IDc}{10607377}
\newcommand{\course}{Computer Science and Engineering}
\newcommand{\supervisor}{Luca Bascetta}
\newcommand{\YEAR}{2022/2023}
\renewcommand{\abstract}{

The Dynamic Window Approach (DWA) is an online collision avoidance strategy for mobile robots.
It incorporates the dynamics of the robot by reducing the search space to only the velocities reachable within a short time interval.

In this work we first present a comparison between the DWA algorithm from the paper and its implementation in Robot Operating System (ROS).

Then, a further comparison is made between the implementation above and a custom trajectory tracking controller, which is composed of an inner linearisation law (based on the kinematic model) and an outer tracking law (based on a proportional integral controller with velocity feed-forward).

}



\begin{document}

\input{config_files/title_page}

\newpage

\renewcommand*\contentsname{Table of Contents}
\tableofcontents

\newpage



%-----------------------------------------------------------------------------
%                               INTRODUCTION
%-----------------------------------------------------------------------------

\section{Introduction}

This project aims at helping a student attending the Control of Mobile Robots course by providing a simple case study which compares the behavior of a robot controlled with DWA and of one controlled with a trajectory tracking control law.\\

The software simulates the robot, using its kinematic model, and implements the two controllers. Everything runs on ROS Melodic on Ubuntu 18.04 LTS.



%-----------------------------------------------------------------------------
%                               DWA OVERVIEW
%-----------------------------------------------------------------------------

\section{DWA overview}

This section is basically a brief overview of the Dynamic Window Approach (DWA) as presented in the original paper\footnote{D. Fox, W. Burgard, S. Thrun (1997) \textit{The Dynamic Window Approach to Collision Avoidance}}.\\

DWA is an approach to perform collision avoidance in mobile robots, while dealing with the constraints imposed by limited velocities and accelerations.

\subsection{Search Space}

This approach consists in reducing the search space to those velocities which are reachable under the dynamic constraints and are safe with respect to obstacles.

One of the core concepts of DWA is the so-called search space. It can be seen as a two-dimensional space where each point represents a tuple $(v, \omega)$ of velocities where $v$ is the linear velocity of the robot and $\omega$ is the angular velocity.\\

Starting from a sequence of n future time intervals, DWA performs a forward simulation of different values for the velocities keeping them constant for those time intervals.

As a result, the simulated trajectories are all circular arcs, and the most suitable one (we will go into details when talking about the cost function) is selected.\\

The search space of the possible velocities is further reduced in other two steps.

First, we consider only all the admissible velocities, which correspond to the velocities allowing the robot to stop before it reaches the closest obstacle on the corresponding curvature.

Then, we leave out all the velocities that can't be reached within a short time interval
given the limited accelerations of the robot.

\subsection{Optimization}

The remaining velocities are fed into the following objective function to maximize it:
$$ G(v, \omega) = \sigma(\alpha \cdot heading(v, \omega) + \beta \cdot dist(v, \omega) + \gamma \cdot vel(v, \omega)) $$

This function trades off the following aspects:
\begin{itemize}
 \item \textit{heading}, which is a measure of progress towards the goal location;
 \item \textit{dist}, which is the distance to the closest obstacle on the trajectory;
 \item \textit{vel}, which is the forward velocity of the robot.\\
\end{itemize}

Each one of the three quantities above is multiplied to its own weight ($\alpha$, $\beta$, $\gamma$), and the resulting quantity is passed to a smoothing function ($\sigma$).



%-----------------------------------------------------------------------------
%                               DWA IN ROS
%-----------------------------------------------------------------------------

\section{DWA in ROS}

\subsection{From ROS wiki}

DWA is already implemented in ROS in the \href{https://wiki.ros.org/dwa\_local\_planner}{\texttt{dwa\_local\_planner}}\footnote{https://wiki.ros.org/dwa\_local\_planner} package.

As stated in the ROS Wiki:
\begin{quote}
 The dwa\_local\_planner package provides a controller that drives a mobile base in the plane. This controller serves to connect the path planner to the robot. Using a map, the planner creates a kinematic trajectory for the robot to get from a start to a goal location. Along the way, the planner creates, at least locally around the robot, a value function, represented as a grid map. This value function encodes the costs of traversing through the grid cells. The controller's job is to use this value function to determine dx,dy,dtheta velocities to send to the robot.
\end{quote}

This package is ought to be used as the planner for \href{https://wiki.ros.org/move\_base}{\texttt{move\_base}}\footnote{https://wiki.ros.org/move\_base} within the navigation stack.

\subsection{Comparison with the paper formulation}

... (cost function)



%-----------------------------------------------------------------------------
%                             SETUP OF THE EXPERIMENT
%-----------------------------------------------------------------------------

\section{Setup of the experiment}

\subsection{The robot}

In our experiment we chose to simulate a small differential drive robot.\\

In particular, it is characterized by two main dimensions (specified as YAML parameters in the code):
\begin{itemize}
 \item \texttt{d} = 15 cm, which is the distance between the two motorized wheels;
 \item \texttt{r} = 3 cm, which is the radius of the two motorized wheels.\\
\end{itemize}

The precise footprint is a pentagon, just for convenience, so that when looking at it we are able to determine the orientation of the robot.
However, this is not a decisive detail since it has o influence on the robot's behavior.


\subsection{The map}

Regarding the map, it is important to highlight the different setting we have with respect to the usual DWA use.

There are two main differences:
\begin{itemize}
 \item in our setting there are no obstacles, neither fixed nor moving;
 \item the robot does not have any sensor.\\
\end{itemize}

As a consequence, we don't need both the local map and the global map, but only the local one.

Moreover, this map needs to be empty so it is generated starting from a totally white image.


\subsection{The trajectory}

The robot must follow a precise trajectory, which is used to perform all benchmarks.

In our case we chose an eight-shaped trajectory with a dimension of 2 x 1 meters.\\

In order to make DWA compute the velocities of the robot, we must feed it a goal.

This means that the complete trajectory has to be "discretized" in multiple points.
Each one of these points is passed to DWA as the current goal, and once it is reached the next point is set as the new goal. You will find a detailed explanation in the following sections.



%-----------------------------------------------------------------------------
%                               IMPLEMENTATION
%-----------------------------------------------------------------------------

\section{Implementation}

\subsection{Architecture overview}

... (things in common between our controller and DWA: simulator, ...)

\subsection{Simulator}

...

\subsection{Trajectory controller}

...

\subsection{DWA controller}

...



%-----------------------------------------------------------------------------
%                               PARAMETERS TUNING
%-----------------------------------------------------------------------------

\section{Parameters tuning}

...



%-----------------------------------------------------------------------------
%                               EXPERIMENTAL RESULTS
%-----------------------------------------------------------------------------

\section{Experimental Results}

... (plots of the bags + plots of the comparison with the custom script)



%-----------------------------------------------------------------------------
%                               ENCOUNTERED PROBLEMS
%-----------------------------------------------------------------------------

\section{Encountered problems}

... (deprecated parameters name in the official doc: put screen of the doc +
screen of the comments in the code of the library)
% 


%-----------------------------------------------------------------------------
%                               USAGE OF THE CODE
%-----------------------------------------------------------------------------

\section{Usage of the code}

...



%-----------------------------------------------------------------------------
%                               CONCLUSIONS
%-----------------------------------------------------------------------------

\section{Conclusions}

...



\end{document}
